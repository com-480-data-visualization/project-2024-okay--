<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Olympic Games</title>
    <link rel="stylesheet" href="styles/index.css" />

    <script src="mapdata.js"></script>		
    <script src="worldmap.js"></script>
  </head>
  <body>
    <div id="map"></div>
    <input type="file" id="csvFile" accept=".csv">
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        simplemaps_worldmap.load(function() {
          // Map is fully loaded now, it's safe to call projection functions

          // Set up file reader
          document.getElementById('csvFile').addEventListener('change', function(event) {
              const file = event.target.files[0];
              const reader = new FileReader();
        
              reader.onload = function(e) {
                  const csvText = e.target.result;
                  processCSV(csvText);
              };
        
              reader.readAsText(file);
          });
        
          function processCSV(csvText) {
            const lines = csvText.split('\n');
            lines.forEach((line, index) => {
                if (index > 0 && line) { // Ignoring the header
                    const parts = line.split(',');
                    const latitude = parseFloat(parts[6]);
                    const longitude = parseFloat(parts[7]);
                    if (!isNaN(latitude) && !isNaN(longitude)) {
                        const coords = simplemaps_worldmap.proj(latitude, longitude);
                        console.log(`Original: (${latitude}, ${longitude}) => Projected: (${coords.x}, ${coords.y})`);
                    }
                }
            });
          }
        });
      });
    </script>
  </body>
</html>
